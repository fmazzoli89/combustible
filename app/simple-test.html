<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 0;
            display: block;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 4px;
            white-space: pre-wrap;
            font-family: monospace;
            min-height: 200px;
        }
    </style>
</head>
<body>
    <h1>Simple API Test</h1>
    <p>This page tests the API endpoints with minimal dependencies.</p>
    
    <button onclick="testAPI()">Test API</button>
    <button onclick="testHelloAPI()">Test Hello API</button>
    <button onclick="testLocalAPI()">Test Local API</button>
    <button onclick="testCORS()">Test CORS</button>
    
    <div id="results">Results will appear here...</div>
    
    <script>
        // Function to log results
        function log(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.textContent += message + '\n';
        }
        
        // Clear results
        function clearResults() {
            document.getElementById('results').textContent = '';
        }
        
        // Test the Vercel API endpoint
        async function testAPI() {
            clearResults();
            log('Testing Vercel API endpoint...');
            
            try {
                const startTime = Date.now();
                log(`Sending request to https://combustible-tramec.vercel.app/api/sheets-test at ${new Date().toISOString()}`);
                
                const response = await fetch('https://combustible-tramec.vercel.app/api/sheets-test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ test: true })
                });
                
                const endTime = Date.now();
                log(`Response received in ${endTime - startTime}ms`);
                log(`Status: ${response.status} ${response.statusText}`);
                
                // Log headers
                log('Response headers:');
                for (const [key, value] of response.headers.entries()) {
                    log(`  ${key}: ${value}`);
                }
                
                // Get response text
                const text = await response.text();
                log(`Response body (${text.length} bytes):`);
                log(text);
                
                // Try to parse as JSON
                try {
                    const json = JSON.parse(text);
                    log('Parsed as JSON:');
                    log(JSON.stringify(json, null, 2));
                } catch (e) {
                    log(`Error parsing JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
                log(`Stack: ${error.stack}`);
            }
        }
        
        // Test the Hello API endpoint
        async function testHelloAPI() {
            clearResults();
            log('Testing Hello API endpoint...');
            
            try {
                const startTime = Date.now();
                log(`Sending request to https://combustible-tramec.vercel.app/api/hello at ${new Date().toISOString()}`);
                
                const response = await fetch('https://combustible-tramec.vercel.app/api/hello');
                
                const endTime = Date.now();
                log(`Response received in ${endTime - startTime}ms`);
                log(`Status: ${response.status} ${response.statusText}`);
                
                // Log headers
                log('Response headers:');
                for (const [key, value] of response.headers.entries()) {
                    log(`  ${key}: ${value}`);
                }
                
                // Get response text
                const text = await response.text();
                log(`Response body (${text.length} bytes):`);
                log(text);
                
                // Try to parse as JSON
                try {
                    const json = JSON.parse(text);
                    log('Parsed as JSON:');
                    log(JSON.stringify(json, null, 2));
                } catch (e) {
                    log(`Error parsing JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
                log(`Stack: ${error.stack}`);
            }
        }
        
        // Test a local API endpoint
        async function testLocalAPI() {
            clearResults();
            log('Testing local API endpoint...');
            
            try {
                const startTime = Date.now();
                const localUrl = window.location.protocol + '//' + window.location.host + '/api/sheets-test';
                log(`Sending request to ${localUrl} at ${new Date().toISOString()}`);
                
                const response = await fetch(localUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ test: true })
                });
                
                const endTime = Date.now();
                log(`Response received in ${endTime - startTime}ms`);
                log(`Status: ${response.status} ${response.statusText}`);
                
                // Get response text
                const text = await response.text();
                log(`Response body (${text.length} bytes):`);
                log(text);
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }
        
        // Test CORS with a known public API
        async function testCORS() {
            clearResults();
            log('Testing CORS with a public API...');
            
            try {
                const startTime = Date.now();
                log(`Sending request to https://jsonplaceholder.typicode.com/todos/1 at ${new Date().toISOString()}`);
                
                const response = await fetch('https://jsonplaceholder.typicode.com/todos/1');
                
                const endTime = Date.now();
                log(`Response received in ${endTime - startTime}ms`);
                log(`Status: ${response.status} ${response.statusText}`);
                
                // Get response text
                const text = await response.text();
                log(`Response body (${text.length} bytes):`);
                log(text);
                
                // Try to parse as JSON
                try {
                    const json = JSON.parse(text);
                    log('Parsed as JSON:');
                    log(JSON.stringify(json, null, 2));
                } catch (e) {
                    log(`Error parsing JSON: ${e.message}`);
                }
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }
    </script>
</body>
</html> 